<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Jun Zhang">
<title>Peptide motif plot â€“ RiboTransVis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Motif-centered.html" rel="next">
<link href="./Multipeptide-occupancy.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f1075ac1703e165f0c9b3df650605ffb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script defer="" data-domain="r4ds.hadley.nz" src="https://plausible.io/js/plausible.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Peptide-motif-plot.html">Peptide motif plot</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">RiboTransVis</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/junjunlab/riboTransVis" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Preprocessing-into.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preprocessing introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Preprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Extract-sequence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Extract sequence</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Object-construct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Object construct</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Quality-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quality assessment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ribo-QC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ribo-seq QC check</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Length-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Length distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Frame-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">In frame ratio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Periodicy-check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Periodicity check</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Feature-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Feature distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Meta-frame-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Meta frame plot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Meta-heatmap-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Meta heatmap plot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Offset-check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Offset check</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Whole-metagene-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Whole metegene plot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Metagene-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Metagene plot</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Offset-correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Offset correction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Polarity-calculation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Polarity score</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Codon-occupancy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Codon occupancy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Multipeptide-occupancy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple peptides occupancy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Peptide-motif-plot.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Peptide motif plot</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Motif-centered.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motif centered analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Track-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Track plot</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Gene-expression-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Global gene expression analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pathway-enrichment-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pathway enrichment analysis</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./More-examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">More examples</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ubiquitin-conjugase-Rad6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ubiquitin conjugase Rad6</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DENR-promotes-translation-reinitiation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">DENR promotes translation reinitiation</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro">Intro</a></li>
  <li><a href="#extract-overrepresented-motifs" id="toc-extract-overrepresented-motifs" class="nav-link" data-scroll-target="#extract-overrepresented-motifs">Extract <strong>Overrepresented</strong> motifs</a></li>
  <li><a href="#motif-logo-visualization" id="toc-motif-logo-visualization" class="nav-link" data-scroll-target="#motif-logo-visualization">Motif logo visualization</a></li>
  <li>
<a href="#statistical-significance-visualization" id="toc-statistical-significance-visualization" class="nav-link" data-scroll-target="#statistical-significance-visualization"><strong>Statistical significance visualization</strong></a>
  <ul class="collapse">
<li><a href="#get-background-k-mers" id="toc-get-background-k-mers" class="nav-link" data-scroll-target="#get-background-k-mers">Get background k-mers</a></li>
  <li><a href="#enrichment-plot" id="toc-enrichment-plot" class="nav-link" data-scroll-target="#enrichment-plot">Enrichment plot</a></li>
  <li><a href="#return-enrichment-matrix" id="toc-return-enrichment-matrix" class="nav-link" data-scroll-target="#return-enrichment-matrix">Return enrichment matrix</a></li>
  </ul>
</li>
  <li>
<a href="#theoretical-principle-of-plogo" id="toc-theoretical-principle-of-plogo" class="nav-link" data-scroll-target="#theoretical-principle-of-plogo">Theoretical Principle of pLogo</a>
  <ul class="collapse">
<li><a href="#statistical-model" id="toc-statistical-model" class="nav-link" data-scroll-target="#statistical-model">Statistical Model</a></li>
  <li><a href="#residue-significance-and-height-calculation" id="toc-residue-significance-and-height-calculation" class="nav-link" data-scroll-target="#residue-significance-and-height-calculation">Residue Significance and Height Calculation</a></li>
  <li><a href="#bonferroni-correction-and-significance-threshold" id="toc-bonferroni-correction-and-significance-threshold" class="nav-link" data-scroll-target="#bonferroni-correction-and-significance-threshold">Bonferroni Correction and Significance Threshold</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">Reference</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/junjunlab/riboTransVis/edit/main/Peptide-motif-plot.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/junjunlab/riboTransVis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Peptide motif plot</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="intro" class="level2"><h2 class="anchored" data-anchor-id="intro">Intro</h2>
<p>This section focuses on visualizing peptide motifs derived from ribosome profiling (Ribo-seq) analyses. During translation, the ribosome orchestrates protein synthesis by cycling through three key active sites: the <strong>E (exit)</strong>, <strong>P (peptidyl)</strong>, and <strong>A (aminoacyl)</strong> sites. Each of these sites plays a critical role in decoding mRNA and elongating the nascent peptide chain. The A site is responsible for decoding the mRNA codon by matching it with the correct aminoacyl-tRNA; the P site holds the growing peptide chain and participates in peptide bond formation; and the E site facilitates the exit of deacylated tRNA.</p>
<p>The time a ribosome spends decoding a codonâ€”often referred to as dwell timeâ€”can vary depending on the sequence context around these EPA sites. This variability can lead to ribosome stalling, particularly when rare codons, nascent peptide-induced structural constraints, or regulatory elements interfere with efficient translation. For instance, negatively charged or bulky amino acids at the A site may delay tRNA accommodation and peptide bond formation, thereby increasing the decoding time. Similarly, specific <strong>dipeptide</strong> or <strong>tripeptide</strong> motifs spanning the P and A sites can hinder peptide elongation due to steric or electrostatic interactions.</p>
<p>Ribosome profiling (Ribo-seq) enables high-resolution mapping of ribosome positions on mRNAs, providing a powerful tool to quantify dwell times at codon-level resolution. By mapping footprint reads centered at specific positions (e.g., aligning the A site), researchers can aggregate sequence motifs that correspond to prolonged ribosome occupancy, revealing patterns of enrichment or depletion in amino acid usage.</p>
<p>To visualize such motifs, statistical tools like pLogo can be employed. Unlike traditional sequence logos that scale residues by frequency, <a href="https://plogo.uconn.edu/"><strong>pLogo</strong></a> represents amino acid enrichment or depletion as a function of statistical significance against a defined background. This enables a more rigorous interpretation of sequence features that tend to promote or hinder translation at the ribosomeâ€™s active sites. Moreover, pLogo allows for motif conditioning by fixing residues at specific positions (e.g., a conserved P-site proline), thus uncovering context-dependent translation dynamics.</p>
<p><a href="http://kplogo.wi.mit.edu/manual.html"><strong>kpLogo</strong></a> is an another powerful computational tool designed to visualize position-specific <strong>k-mer enrichment patterns</strong> in biological sequences such as DNA, RNA, or protein sequences. It builds upon the concept of traditional sequence logos by enabling the detection and display of statistically significant k-mers â€” not just single residues â€” at individual motif positions.</p>
<p>Unlike conventional logo tools that scale individual residue heights based on frequency or information content, kpLogo tests all possible k-length substrings (k-mers) at each sequence position and ranks them according to p-values derived from appropriate statistical tests (e.g., binomial, rank-sum, etc.). This results in highly informative visualizations that reveal both overrepresented and underrepresented k-mers across sequence positions.</p>
<p>In summary, decoding time at the EPA sites is a nuanced reflection of codon usage, tRNA availability, peptide chemistry, and regulatory sequence elements. Motif visualization strategies such as pLogo help unravel the sequence determinants influencing ribosome kinetics in a biologically meaningful and statistically interpretable way.</p>
</section><section id="extract-overrepresented-motifs" class="level2"><h2 class="anchored" data-anchor-id="extract-overrepresented-motifs">Extract <strong>Overrepresented</strong> motifs</h2>
<p>Previously, we observed that in the absence of eIF5A, many tripeptide motifs showed increased abundance. Visualizing these motifs as sequence logos can help us identify which amino acids tend to be enriched at the ribosomal E, P, and A sites, potentially reflecting altered decoding or elongation dynamics.</p>
<p>We used the <code>logo_plot()</code> function to visualize enriched tripeptide motifs. Based on the articleâ€™s methodology, we selected the top <strong>29 upregulated motifs</strong> (based on fold change) in each replicate as the foreground sequences. Motifs with <strong>less than 1.5-fold change</strong> were used as the background set:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate fold changes</span></span>
<span><span class="va">pdf</span><span class="op">$</span><span class="va">ratio1</span> <span class="op">&lt;-</span> <span class="va">pdf</span><span class="op">$</span><span class="va">`sgeIF5A-rep1`</span> <span class="op">/</span> <span class="va">pdf</span><span class="op">$</span><span class="va">`wt-rep1`</span></span>
<span><span class="va">pdf</span><span class="op">$</span><span class="va">ratio2</span> <span class="op">&lt;-</span> <span class="va">pdf</span><span class="op">$</span><span class="va">`sgeIF5A-rep2`</span> <span class="op">/</span> <span class="va">pdf</span><span class="op">$</span><span class="va">`wt-rep2`</span></span>
<span></span>
<span><span class="co"># Select top 29 enriched motifs for each replicate</span></span>
<span><span class="va">enrich1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">pdf</span>, <span class="va">ratio1</span> <span class="op">&gt;=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">ratio1</span>, n <span class="op">=</span> <span class="fl">29</span><span class="op">)</span></span>
<span></span>
<span><span class="va">enrich1.bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">pdf</span>, <span class="va">ratio1</span> <span class="op">&lt;</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">enrich2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">pdf</span>, <span class="va">ratio2</span> <span class="op">&gt;=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">ratio2</span>, n <span class="op">=</span> <span class="fl">29</span><span class="op">)</span></span>
<span></span>
<span><span class="va">enrich2.bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">pdf</span>, <span class="va">ratio2</span> <span class="op">&lt;</span> <span class="fl">1.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="motif-logo-visualization" class="level2"><h2 class="anchored" data-anchor-id="motif-logo-visualization">Motif logo visualization</h2>
<p>Default plot:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">logo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">enrich1</span><span class="op">$</span><span class="va">pep_seq</span>,</span>
<span>          method <span class="op">=</span> <span class="st">"bits"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">logo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">enrich2</span><span class="op">$</span><span class="va">pep_seq</span>,</span>
<span>            method <span class="op">=</span> <span class="st">"bits"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/bits.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Set <code>method = "prob"</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">logo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">enrich1</span><span class="op">$</span><span class="va">pep_seq</span>,</span>
<span>          method <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">logo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">enrich2</span><span class="op">$</span><span class="va">pep_seq</span>,</span>
<span>            method <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/prob.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>We further used the <strong>EDLogo</strong> method from the <strong>logolas</strong> R package to visualize motif enrichment:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">logo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">enrich1</span><span class="op">$</span><span class="va">pep_seq</span>,</span>
<span>          method <span class="op">=</span> <span class="st">"EDLogo"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">logo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">enrich2</span><span class="op">$</span><span class="va">pep_seq</span>,</span>
<span>            method <span class="op">=</span> <span class="st">"EDLogo"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/logolas.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Visualize frequency enrichment by incorporating background sequences. Residue height represents the <strong>logâ‚‚ enrichment ratio of the amino acid frequency at a given position in the foreground relative to the background</strong>.</p>
<p>To visualize frequency enrichment using background sequences, each amino acid at a given position is evaluated for its level of enrichment or depletion in the foreground set compared to the background.</p>
<p>The height of each amino acid character represents the logâ‚‚ enrichment ratio between its frequency in the foreground and background sequences:</p>
<p><span class="math display">\[
\text{Enrichment ratio for residue } X_i = \log_2 \left( \frac{f_{\text{foreground}}(X_i)}{f_{\text{background}}(X_i)} \right) \tag{1}
\]</span></p>
<ul>
<li>
<strong>X</strong> refers to a specific amino acid (from the 20 standard amino acids).</li>
<li>
<strong>i</strong> indicates a specific position in the aligned sequence.</li>
</ul>
<p>If the ratio is greater than 1 (logâ‚‚ &gt; 0), the residue is statistically <strong>overrepresented</strong> and appears taller above the x-axis.<br>
If the ratio is less than 1 (logâ‚‚ &lt; 0), the residue is <strong>underrepresented</strong> and appears below the x-axis.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">logo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">enrich1</span><span class="op">$</span><span class="va">pep_seq</span>,</span>
<span>          background_seqs <span class="op">=</span> <span class="va">enrich1.bg</span><span class="op">$</span><span class="va">pep_seq</span>,</span>
<span>          method <span class="op">=</span> <span class="st">"enrich"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">logo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">enrich2</span><span class="op">$</span><span class="va">pep_seq</span>,</span>
<span>            background_seqs <span class="op">=</span> <span class="va">enrich2.bg</span><span class="op">$</span><span class="va">pep_seq</span>,</span>
<span>            method <span class="op">=</span> <span class="st">"enrich"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/bgenrich.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>If background sequences are not available, you can generate them by using the <code>generate_kmers</code> function to extract all possible amino acid <strong>k-mers</strong> of a specified length from the <strong>entire proteome</strong>. Here we load CDS fasta file and translate it into amino acid:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># generate kmers</span></span>
<span><span class="va">kmer</span> <span class="op">&lt;-</span> <span class="fu">generate_kmers</span><span class="op">(</span>fa_file <span class="op">=</span> <span class="st">"sac_cds.fa"</span>,</span>
<span>                       fa_type <span class="op">=</span> <span class="st">"dna"</span>, </span>
<span>                       kmer_length <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                       translate <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu">logo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">enrich1</span><span class="op">$</span><span class="va">pep_seq</span>,</span>
<span>          background_seqs <span class="op">=</span> <span class="va">kmer</span>,</span>
<span>          method <span class="op">=</span> <span class="st">"enrich"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">logo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">enrich2</span><span class="op">$</span><span class="va">pep_seq</span>,</span>
<span>            background_seqs <span class="op">=</span> <span class="va">kmer</span>,</span>
<span>            method <span class="op">=</span> <span class="st">"enrich"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/kmer.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section><section id="statistical-significance-visualization" class="level2"><h2 class="anchored" data-anchor-id="statistical-significance-visualization"><strong>Statistical significance visualization</strong></h2>
<p><strong>Probability logo</strong> is first proposed and implemented in&nbsp;<a href="https://plogo.uconn.edu/">pLogo</a>&nbsp;for unweighted sequences, especially protein sequences.&nbsp;In probability logos, residues are scaled relative to the <strong>statistical significance (-log10(<em>P</em>&nbsp;value))</strong> of each residue at each position. <strong>Enriched residues stack on the top, whereas depleted residues stack on the bottom. Significant positions have coordinates colored in red.</strong></p>
<p>The official pLogo tool is only available online and imposes size limitations on uploaded background sequences. To address this limitation and enable greater flexibility, <strong>we implemented an R-based version of the pLogo algorithm based on its original principles</strong>.</p>
<p>Our custom function, <code>plogo_plot</code>, allows users to perform motif enrichment analysis using their own foreground and background sequences and to generate corresponding motif visualizations.</p>
<p>The figure below is adapted from Figure 1 of the pLogo publication and illustrates specific sequence motifs from <strong>human</strong> and <strong>mouse</strong> data. To reproduce this figure, we downloaded the sequence datasets provided in the <strong>articleâ€™s supplementary materials</strong> and reanalyzed them using our own implementation.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/plogo.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<section id="get-background-k-mers" class="level3"><h3 class="anchored" data-anchor-id="get-background-k-mers">Get background k-mers</h3>
<p>To build background sequence datasets, we first downloaded the complete <strong>human</strong> and <strong>mouse proteomes</strong> from the <strong>Ensembl</strong> database. Using the custom R function <code>generate_kmers</code>, we generated all possible <strong>15-mer peptide</strong> subsequences using a <strong>1-residue sliding window</strong>.</p>
<p>We select the <strong>longest amino acid sequence</strong> for analysis to reduce computation time:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Download human and mouse protein sequences from Ensembl</span></span>
<span><span class="co"># wget https://ftp.ensembl.org/pub/release-113/fasta/homo_sapiens/pep/Homo_sapiens.GRCh38.pep.all.fa.gz</span></span>
<span><span class="co"># wget https://ftp.ensembl.org/pub/release-113/fasta/mus_musculus/pep/Mus_musculus.GRCm39.pep.all.fa.gz</span></span>
<span></span>
<span><span class="co"># select longest cds for analysis</span></span>
<span><span class="va">pep.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Homo_sapiens.GRCh38.pep.all.fa.gz"</span>,</span>
<span>                     <span class="st">"Mus_musculus.GRCm39.pep.all.fa.gz"</span><span class="op">)</span>, </span>
<span>                   <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>                     <span class="va">hm.pep</span> <span class="op">&lt;-</span> <span class="fu">Biostrings</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-io.html">readAAStringSet</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">hm.pep</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">hm.pep</span><span class="op">)</span>,split <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">4</span><span class="op">)</span></span>
<span>                     </span>
<span>                     <span class="va">leninfo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">hm.pep</span><span class="op">)</span>,</span>
<span>                                           len <span class="op">=</span> <span class="fu">Biostrings</span><span class="fu">::</span><span class="fu">width</span><span class="op">(</span><span class="va">hm.pep</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>                       <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">len</span>,n <span class="op">=</span> <span class="fl">1</span>,by <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span>                     </span>
<span>                     <span class="va">hm.pep</span> <span class="op">&lt;-</span> <span class="va">hm.pep</span><span class="op">[</span><span class="va">leninfo</span><span class="op">$</span><span class="va">id</span><span class="op">]</span></span>
<span>                   <span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Generate background sequences encompassing the complete set of k-mer combinations:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Generate human background 15-mers</span></span>
<span><span class="va">hm.kmers</span> <span class="op">&lt;-</span> <span class="fu">generate_kmers</span><span class="op">(</span>fa_obj <span class="op">=</span> <span class="va">pep.list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                           fa_type <span class="op">=</span> <span class="st">"aa"</span>,</span>
<span>                           kmer_length <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">hm.kmers</span><span class="op">)</span></span>
<span><span class="co"># [1] "XTDKLIFGKGTRVTV" "TDKLIFGKGTRVTVE" "XIQGAQKLVFGQGTR" "IQGAQKLVFGQGTRL" "QGAQKLVFGQGTRLT"</span></span>
<span><span class="co"># [6] "GAQKLVFGQGTRLTI"</span></span>
<span></span>
<span><span class="co"># Generate mouse background 15-mers</span></span>
<span><span class="va">mm.kmers</span> <span class="op">&lt;-</span> <span class="fu">generate_kmers</span><span class="op">(</span>fa_obj <span class="op">=</span> <span class="va">pep.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                           fa_type <span class="op">=</span> <span class="st">"aa"</span>,</span>
<span>                           kmer_length <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mm.kmers</span><span class="op">)</span></span>
<span><span class="co"># [1] "MRCLAEFLRLLVLWI" "RCLAEFLRLLVLWIP" "CLAEFLRLLVLWIPA" "LAEFLRLLVLWIPAT" "AEFLRLLVLWIPATG"</span></span>
<span><span class="co"># [6] "EFLRLLVLWIPATGD"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="enrichment-plot" class="level3"><h3 class="anchored" data-anchor-id="enrichment-plot">Enrichment plot</h3>
<p>First, we load the motif sequences of interest. With the sequences prepared, we can now perform statistical enrichment analysis and visualization using the <code>plogo_plot</code> function:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load sequence data</span></span>
<span><span class="va">logo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"logo.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot human Src phosphorylation site motif using merged enrichment and depletion</span></span>
<span><span class="fu">plogo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">logo</span><span class="op">$</span><span class="va">X312.Human.Src.Phosphorylation.Sites</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">312</span><span class="op">]</span>,</span>
<span>           background_seqs <span class="op">=</span> <span class="va">hm.kmers</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/hmlogo.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>To separate enriched and depleted residues into two distinct panels for clearer interpretation:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Display enriched and depleted residues in separate panels</span></span>
<span><span class="fu">plogo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">logo</span><span class="op">$</span><span class="va">X312.Human.Src.Phosphorylation.Sites</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">312</span><span class="op">]</span>,</span>
<span>           background_seqs <span class="op">=</span> <span class="va">hm.kmers</span>,</span>
<span>           type <span class="op">=</span> <span class="st">"sep"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/hmlogosep.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>To visualize the motif specific to mouse <strong>S-nitrosylation sites</strong>:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize enrichment/depletion in mouse S-nitrosylation data</span></span>
<span><span class="fu">plogo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">logo</span><span class="op">$</span><span class="va">X897.Mouse.S.Nitrosylation.Sites</span>,</span>
<span>           background_seqs <span class="op">=</span> <span class="va">mm.kmers</span>,</span>
<span>           type <span class="op">=</span> <span class="st">"sep"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/mmlogo.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section><section id="return-enrichment-matrix" class="level3"><h3 class="anchored" data-anchor-id="return-enrichment-matrix">Return enrichment matrix</h3>
<p>By setting <code>return_data = TRUE</code> in the <strong>plogo_plot</strong> function, users can extract the underlying log-odds enrichment matrix instead of generating the default plot. This matrix contains log-scaled enrichment or depletion scores for each amino acid at each sequence position, allowing users to perform downstream customized visualizations or statistical analyses:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">logo.mat</span> <span class="op">&lt;-</span> <span class="fu">plogo_plot</span><span class="op">(</span>foreground_seqs <span class="op">=</span> <span class="va">logo</span><span class="op">$</span><span class="va">X897.Mouse.S.Nitrosylation.Sites</span>,</span>
<span>           background_seqs <span class="op">=</span> <span class="va">mm.kmers</span>,</span>
<span>           type <span class="op">=</span> <span class="st">"sep"</span>,</span>
<span>           return_data <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">logo.mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#         [,1]        [,2]       [,3]       [,4]         [,5]</span></span>
<span><span class="co"># A  3.0019778  0.45066123  1.2935104  0.3054578  0.675915762</span></span>
<span><span class="co"># R  1.6779435  0.89863638 -0.1011318 -0.6101936 -0.004278364</span></span>
<span><span class="co"># N  0.2781619 -0.57423131  0.2729732  1.0391953  0.040842459</span></span>
<span><span class="co"># D  0.6988828  0.05319199  1.7465229  1.3097744  0.573454875</span></span>
<span><span class="co"># C -1.6254121 -2.24066000 -2.2491104 -2.2449261 -1.634282743</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="theoretical-principle-of-plogo" class="level2"><h2 class="anchored" data-anchor-id="theoretical-principle-of-plogo">Theoretical Principle of pLogo</h2>
<p>pLogo (probability logo) is a motif visualization tool that scales residue characters not by raw frequency but by the statistical significance of their over- or underrepresentation compared to a defined background model, typically using binomial probability.</p>
<section id="statistical-model" class="level3"><h3 class="anchored" data-anchor-id="statistical-model">Statistical Model</h3>
<p>For a given residue r at position i in the foreground dataset (e.g., aligned modification sites), pLogo compares its observed count K with its expected frequency p, derived from the background dataset. Assuming N sequences in the foreground, the probability model is:</p>
<p><span class="math display">\[
K \sim \text{Binomial}(N, p) \tag{2}
\]</span></p>
<p>Where:</p>
<ul>
<li>K: observed count of residue r at position i in the foreground</li>
<li>N: total number of foreground sequences</li>
<li>p: background frequency of residue r at that position</li>
</ul></section><section id="residue-significance-and-height-calculation" class="level3"><h3 class="anchored" data-anchor-id="residue-significance-and-height-calculation">Residue Significance and Height Calculation</h3>
<p>The log-odds score for residue r at position i, which determines its vertical height in the pLogo visualization, is calculated as:</p>
<p><span class="math display">\[
\text{Height}(r_i) \propto \log_{10} \left( \frac{\Pr(k \ge K \mid N, p)}{\Pr(k \le K \mid N, p)} \right) \tag{3}
\]</span></p>
<p>This score provides a continuous probability-based metric reflecting both enrichment and depletion. It approximates:</p>
<p><span class="math display">\[
h(r, i) =
\begin{cases}
+\log_{10} \left( \frac{1}{\Pr(k \ge K \mid N, p)} \right), &amp; K &gt; Np \\
-\log_{10} \left( \frac{1}{\Pr(k \le K \mid N, p)} \right), &amp; K &lt; Np \\
0, &amp; K \approx Np
\end{cases} \tag{4}
\]</span></p>
<p>Here, residues with higher scores are displayed above the x-axis (significantly enriched), while those with negative scores appear below (significantly depleted).</p>
</section><section id="bonferroni-correction-and-significance-threshold" class="level3"><h3 class="anchored" data-anchor-id="bonferroni-correction-and-significance-threshold">Bonferroni Correction and Significance Threshold</h3>
<p>To correct for multiple hypothesis testing across all residue-position pairs, a Bonferroni-adjusted threshold is applied. The number of independent tests is approximately:</p>
<p><span class="math display">\[
m = \sum_{i \in R} C_i \tag{5}
\]</span></p>
<p>Where:</p>
<ul>
<li>R: set of non-fixed positions</li>
<li>C_i: number of unique residues observed at position i in the background</li>
</ul>
<p>The corrected alpha level is:</p>
<p><span class="math display">\[
\alpha' = \frac{0.05}{m} \tag{6}
\]</span></p>
<p>The threshold for visualizing statistical significance on the pLogo is then:</p>
<p><span class="math display">\[
\text{Threshold} = \pm \log_{10} \left( \frac{\alpha'}{1 - \alpha'} \right) \tag{7}
\]</span></p>
</section><section id="reference" class="level3"><h3 class="anchored" data-anchor-id="reference">Reference</h3>
<p>This approach was introduced in:</p>
<blockquote class="blockquote">
<p>Oâ€™Shea JP, Chou MF, Quader SA, et al.&nbsp;<a href="https://doi.org/10.1038/nmeth.2646">pLogo: a probabilistic approach to visualizing sequence motifs</a>. Nature Methods (2013), 10(12):1211â€“1212.</p>
</blockquote>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/github\.com\/junjunlab\/riboTransVis");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./Multipeptide-occupancy.html" class="pagination-link" aria-label="Multiple peptides occupancy">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Multiple peptides occupancy</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Motif-centered.html" class="pagination-link" aria-label="Motif centered analysis">
        <span class="nav-page-text">Motif centered analysis</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>riboTransVis documentation was written by Jun Zhang.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/junjunlab/riboTransVis/edit/main/Peptide-motif-plot.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/junjunlab/riboTransVis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>