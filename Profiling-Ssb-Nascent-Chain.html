<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Jun Zhang">
<title>18&nbsp; Profiling Ssb-Nascent Chain Interactions – RiboTransVis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./DENR-promotes-translation-reinitiation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f1075ac1703e165f0c9b3df650605ffb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script defer="" data-domain="r4ds.hadley.nz" src="https://plausible.io/js/plausible.js"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./More-examples.html">More examples</a></li><li class="breadcrumb-item"><a href="./Profiling-Ssb-Nascent-Chain.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Profiling Ssb-Nascent Chain Interactions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">RiboTransVis</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/junjunlab/riboTransVis" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Preprocessing-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preprocessing introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Preprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Extract-sequence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Extract sequence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Selective-ribosome-profiling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Selective ribosome profiling</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Object-construct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Object construction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ribotrans-Object.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ribotrans object</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Serp-Object.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Serp object</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Quality-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quality assessment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ribo-QC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ribo-seq QC check</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Length-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Length distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Frame-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">In frame ratio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Periodicy-check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Periodicity check</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Feature-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Feature distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Meta-frame-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Meta frame plot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Meta-heatmap-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Meta heatmap plot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Offset-check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Offset check</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Whole-metagene-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Whole metegene plot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Metagene-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Metagene plot</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Offset-correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Offset correction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Enzyme-digestion-site.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Enzyme digestion site</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Polarity-calculation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Polarity score</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Codon-occupancy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Codon occupancy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Motif-occupancy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motif occupancy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Multipeptide-occupancy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple peptides occupancy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Peptide-motif-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Peptide motif plot</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Motif-centered.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motif centered analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Track-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Track plot</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Enrichment-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Enrichment analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Gene-expression-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Global gene expression analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pathway-enrichment-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pathway enrichment analysis</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./More-examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">More examples</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ubiquitin-conjugase-Rad6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Ubiquitin conjugase Rad6</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DENR-promotes-translation-reinitiation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">DENR promotes translation reinitiation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Profiling-Ssb-Nascent-Chain.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Profiling Ssb-Nascent Chain Interactions</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro"><span class="header-section-number">18.1</span> Intro</a></li>
  <li><a href="#metagene-profiles" id="toc-metagene-profiles" class="nav-link" data-scroll-target="#metagene-profiles"><span class="header-section-number">18.2</span> Metagene profiles</a></li>
  <li><a href="#single-gene-enrichment-profile" id="toc-single-gene-enrichment-profile" class="nav-link" data-scroll-target="#single-gene-enrichment-profile"><span class="header-section-number">18.3</span> Single gene enrichment profile</a></li>
  <li>
<a href="#ssb-targeted-proteins-metagene-profile" id="toc-ssb-targeted-proteins-metagene-profile" class="nav-link" data-scroll-target="#ssb-targeted-proteins-metagene-profile"><span class="header-section-number">18.4</span> Ssb targeted proteins metagene profile</a>
  <ul class="collapse">
<li><a href="#download-protein-category-data" id="toc-download-protein-category-data" class="nav-link" data-scroll-target="#download-protein-category-data"><span class="header-section-number">18.4.1</span> Download protein category data</a></li>
  <li><a href="#calculation-and-visualization" id="toc-calculation-and-visualization" class="nav-link" data-scroll-target="#calculation-and-visualization"><span class="header-section-number">18.4.2</span> Calculation and visualization</a></li>
  </ul>
</li>
  <li>
<a href="#impact-of-rac-on-co-translational-ssb-function" id="toc-impact-of-rac-on-co-translational-ssb-function" class="nav-link" data-scroll-target="#impact-of-rac-on-co-translational-ssb-function"><span class="header-section-number">18.5</span> Impact of RAC on co-translational ssb function</a>
  <ul class="collapse">
<li><a href="#serp-object-construction" id="toc-serp-object-construction" class="nav-link" data-scroll-target="#serp-object-construction"><span class="header-section-number">18.5.1</span> Serp object construction</a></li>
  <li><a href="#adding-offset-information" id="toc-adding-offset-information" class="nav-link" data-scroll-target="#adding-offset-information"><span class="header-section-number">18.5.2</span> Adding offset information</a></li>
  <li><a href="#metagene-profile-for-rac-depletion" id="toc-metagene-profile-for-rac-depletion" class="nav-link" data-scroll-target="#metagene-profile-for-rac-depletion"><span class="header-section-number">18.5.3</span> Metagene profile for RAC depletion</a></li>
  <li><a href="#ssb1-interaction-profiles-for-exemplary-proteins" id="toc-ssb1-interaction-profiles-for-exemplary-proteins" class="nav-link" data-scroll-target="#ssb1-interaction-profiles-for-exemplary-proteins"><span class="header-section-number">18.5.4</span> Ssb1 interaction profiles for exemplary proteins</a></li>
  </ul>
</li>
  <li>
<a href="#interplay-of-ssb-and-nac" id="toc-interplay-of-ssb-and-nac" class="nav-link" data-scroll-target="#interplay-of-ssb-and-nac"><span class="header-section-number">18.6</span> Interplay of ssb and NAC</a>
  <ul class="collapse">
<li><a href="#metagene-profile-for-nac-depletion" id="toc-metagene-profile-for-nac-depletion" class="nav-link" data-scroll-target="#metagene-profile-for-nac-depletion"><span class="header-section-number">18.6.1</span> Metagene profile for NAC depletion</a></li>
  <li><a href="#ssb1-interaction-profiles" id="toc-ssb1-interaction-profiles" class="nav-link" data-scroll-target="#ssb1-interaction-profiles"><span class="header-section-number">18.6.2</span> Ssb1 interaction profiles</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/junjunlab/riboTransVis/edit/main/Profiling-Ssb-Nascent-Chain.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/junjunlab/riboTransVis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./More-examples.html">More examples</a></li><li class="breadcrumb-item"><a href="./Profiling-Ssb-Nascent-Chain.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Profiling Ssb-Nascent Chain Interactions</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Profiling Ssb-Nascent Chain Interactions</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="intro" class="level2" data-number="18.1"><h2 data-number="18.1" class="anchored" data-anchor-id="intro">
<span class="header-section-number">18.1</span> Intro</h2>
<p>The data download and preprocessing steps for the study <strong>“Profiling Ssb-Nascent Chain Interactions Reveals Principles of Hsp70-Assisted Folding”</strong> can be found in the <strong>“Selective-ribosome-profiling”</strong> section. Next, we will reproduce a selection of figures from the paper.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/ssbcell.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="750"></p>
</figure>
</div>
</section><section id="metagene-profiles" class="level2" data-number="18.2"><h2 data-number="18.2" class="anchored" data-anchor-id="metagene-profiles">
<span class="header-section-number">18.2</span> Metagene profiles</h2>
<p>Figure 1B of the study shows that in cells expressing either Ssb1-GFP or Ssb2-GFP, the metagene translatome exhibits a typical accumulation of ribosome footprints near the start codon, reflecting slow translation initiation, followed by a nearly uniform distribution across the first 500 codons. The Ssb1- and Ssb2-bound translatomes are highly similar to each other but differ from the total translatome. Specifically, the mean read density in Ssb-bound translatomes is low within the first 50 codons and then reaches a stable plateau, indicating that Ssb begins to engage nascent chains on average after ~50 amino acids have been synthesized. Since 25–30 residues are still inside the ribosome during translation, this suggests that Ssb starts interacting with nascent chains when approximately 20 amino acids are exposed outside the ribosome:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/1b.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>We use the&nbsp;<code>metagene_plot</code>&nbsp;function to visualize ribosome density in the region from -50 to 1500 nucleotidesrelative to the start codon), with codon as the unit:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">metagene_plot</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>,</span>
<span>              mode <span class="op">=</span> <span class="st">"codon"</span>,</span>
<span>              rel2st_dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">1500</span><span class="op">)</span>,</span>
<span>              facet_wrap <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sample</span>,nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/mtssb.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Alternatively, we can extract the data ourselves for customized plotting:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mt</span> <span class="op">&lt;-</span> <span class="fu">metagene_plot</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>,</span>
<span>                    mode <span class="op">=</span> <span class="st">"codon"</span>,</span>
<span>                    rel2st_dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">1500</span><span class="op">)</span>,</span>
<span>                    return_data <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mt</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 6 × 3</span></span>
<span><span class="co">#  sample         rel    avg</span></span>
<span><span class="co">#  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co"># 1 ssb1_rep1-ip   -16 0.0627</span></span>
<span><span class="co"># 2 ssb1_rep1-ip   -15 0.0829</span></span>
<span><span class="co"># 3 ssb1_rep1-ip   -14 0.0842</span></span>
<span><span class="co"># 4 ssb1_rep1-ip   -13 0.0878</span></span>
<span><span class="co"># 5 ssb1_rep1-ip   -12 0.0805</span></span>
<span><span class="co"># 6 ssb1_rep1-ip   -11 0.0578</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also visualize the data by grouping biological replicates and separately plotting the total and IP samples:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># add groups</span></span>
<span><span class="va">mt</span><span class="op">$</span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">mt</span><span class="op">$</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mt</span><span class="op">$</span><span class="va">tp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">mt</span><span class="op">$</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mt</span><span class="op">$</span><span class="va">rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">mt</span><span class="op">$</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_|-"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mt</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">rel</span>,y <span class="op">=</span> <span class="va">avg</span>,colour <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">rep</span><span class="op">~</span><span class="va">gp</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>        panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>,size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Codons / amino acids"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Mean read density [AU]"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/mtssb2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section><section id="single-gene-enrichment-profile" class="level2" data-number="18.3"><h2 data-number="18.3" class="anchored" data-anchor-id="single-gene-enrichment-profile">
<span class="header-section-number">18.3</span> Single gene enrichment profile</h2>
<p>The article demonstrates that the proteins <strong>PMT1</strong>, <strong>CDC37</strong>, and <strong>CCT3</strong> are among the nascent chains bound by Ssb, as shown in Figure 1:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/pcc.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>我们批量绘制这3个基因的enrichment的track图：</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">glist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PMT1"</span>, <span class="st">"CDC37"</span>, <span class="st">"CCT3"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># x = 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">glist</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">get_occupancy</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                       serp_exp <span class="op">=</span> <span class="st">"total"</span>,</span>
<span>                       gene_name <span class="op">=</span> <span class="va">glist</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,</span>
<span>                       coordinate_to_trans <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                       do_reads_offset <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span> </span>
<span>  <span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">get_occupancy</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                       serp_exp <span class="op">=</span> <span class="st">"ip"</span>,</span>
<span>                       gene_name <span class="op">=</span> <span class="va">glist</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,</span>
<span>                       coordinate_to_trans <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                       do_reads_offset <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">enrichment_plot2</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>,</span>
<span>                        smooth <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                        window_size <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                        mode <span class="op">=</span> <span class="st">"codon"</span>,</span>
<span>                        merge_rep <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                        facet <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">rname</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">plist</span></span>
<span></span>
<span><span class="co"># combine</span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plist</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/sgr.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Gene-by-gene inspection revealed that the small discrepancy in substrate pools is largely due to subtle differences in enrichment factors that affect bioinformatic detection:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/rpls.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">glist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RPL30"</span>, <span class="st">"RPL7A"</span>, <span class="st">"PIR1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># x = 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">glist</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">get_occupancy</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                       serp_exp <span class="op">=</span> <span class="st">"total"</span>,</span>
<span>                       gene_name <span class="op">=</span> <span class="va">glist</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,</span>
<span>                       coordinate_to_trans <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                       do_reads_offset <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">get_occupancy</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                       serp_exp <span class="op">=</span> <span class="st">"ip"</span>,</span>
<span>                       gene_name <span class="op">=</span> <span class="va">glist</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,</span>
<span>                       coordinate_to_trans <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                       do_reads_offset <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">enrichment_plot2</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>,</span>
<span>                     smooth <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                     window_size <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                     mode <span class="op">=</span> <span class="st">"codon"</span>,</span>
<span>                     merge_rep <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                     facet <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">rname</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">plist</span></span>
<span></span>
<span><span class="co"># combine</span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plist</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/sgr2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section><section id="ssb-targeted-proteins-metagene-profile" class="level2" data-number="18.4"><h2 data-number="18.4" class="anchored" data-anchor-id="ssb-targeted-proteins-metagene-profile">
<span class="header-section-number">18.4</span> Ssb targeted proteins metagene profile</h2>
<p>Figure 3B presents metagene binding profiles that characterize how the chaperone protein Ssb interacts with nascent polypeptide chains based on their subcellular localization — specifically, cytoplasmic/nuclear, mitochondrial, and ER-targeted proteins:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/f3b.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<section id="download-protein-category-data" class="level3" data-number="18.4.1"><h3 data-number="18.4.1" class="anchored" data-anchor-id="download-protein-category-data">
<span class="header-section-number">18.4.1</span> Download protein category data</h3>
<p>First, we download the gene classification data provided in the article from the following link:<br><a href="https://www.cell.com/cms/10.1016/j.cell.2017.06.038/attachment/24190c7e-ed24-4329-9349-fe9c72386983/mmc1.xlsx" class="uri">https://www.cell.com/cms/10.1016/j.cell.2017.06.038/attachment/24190c7e-ed24-4329-9349-fe9c72386983/mmc1.xlsx</a></p>
<p>Then, we import and examine the content of the “protein categories” sheet using the <code>readxl</code> package, skipping the first 14 rows which contain metadata or descriptions:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pc</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="st">"../mmc1.xlsx"</span>,sheet <span class="op">=</span> <span class="st">"protein categories"</span>,</span>
<span>                        skip <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 6 × 11</span></span>
<span><span class="co"># cytoplasmic, nuclear …¹ mitochondrial protei…² `ER-targeted proteins` SRP-dependent protei…³ SRP-independent prot…⁴</span></span>
<span><span class="co">#   &lt;chr&gt;                   &lt;chr&gt;                  &lt;chr&gt;                  &lt;chr&gt;                  &lt;chr&gt;                 </span></span>
<span><span class="co"># 1 YPL191C                 YNL003C                YPL051W                YMR058W                YJL052C-A             </span></span>
<span><span class="co"># 2 YJL179W                 YIL124W                YBL102W                YHR138C                YNL238W               </span></span>
<span><span class="co"># 3 YNL288W                 YKL029C                YIL048W                YJR116W                YDR246W-A             </span></span>
<span><span class="co"># 4 YPL144W                 YNR045W                YPL195W                YFR035C                YPL189W               </span></span>
<span><span class="co"># 5 YHR112C                 YNR018W                YGL223C                YML132W                YLR120C               </span></span>
<span><span class="co"># 6 YKR084C                 YKR064W                YDR137W                YJL127C-B              YMR305C               </span></span>
<span><span class="co"># # ℹ abbreviated names: ¹​`cytoplasmic, nuclear proteins`, ²​`mitochondrial proteins`, ³​`SRP-dependent proteins`,</span></span>
<span><span class="co"># #   ⁴​`SRP-independent proteins`</span></span>
<span><span class="co"># # ℹ 6 more variables: `SND-pathway proteins (used for Fig. 3A)` &lt;chr&gt;,</span></span>
<span><span class="co"># #   `SND-pathway proteins (used for Fig. S3F)` &lt;chr&gt;, `Tail-anchored proteins` &lt;chr&gt;,</span></span>
<span><span class="co"># #   `unclassified ER-targeted proteins` &lt;chr&gt;, `SRP substrates (with distinct peak)` &lt;chr&gt;,</span></span>
<span><span class="co"># #   `SRP substrates (pre-recruitment)` &lt;chr&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="calculation-and-visualization" class="level3" data-number="18.4.2"><h3 data-number="18.4.2" class="anchored" data-anchor-id="calculation-and-visualization">
<span class="header-section-number">18.4.2</span> Calculation and visualization</h3>
<p>Then calculate and process the gene names for each gene category:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># choose ssb1 for analysis</span></span>
<span><span class="va">obj2</span> <span class="op">&lt;-</span> <span class="fu">subset_data</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>, <span class="va">sample</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ssb1_rep1"</span>, <span class="st">"ssb1_rep2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># gene features</span></span>
<span><span class="va">ft</span> <span class="op">&lt;-</span> <span class="va">obj2</span><span class="op">@</span><span class="va">features</span></span>
<span></span>
<span><span class="co"># get gene list</span></span>
<span><span class="va">cyto_nuc</span> <span class="op">&lt;-</span> <span class="va">ft</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">transcript_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">pc</span><span class="op">$</span><span class="va">`cytoplasmic, nuclear proteins`</span>,<span class="st">"_mRNA"</span>,sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span> </span>
<span><span class="va">mito</span> <span class="op">&lt;-</span>  <span class="va">ft</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">transcript_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">pc</span><span class="op">$</span><span class="va">`mitochondrial proteins`</span>,<span class="st">"_mRNA"</span>,sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">er</span> <span class="op">&lt;-</span>  <span class="va">ft</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">transcript_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">pc</span><span class="op">$</span><span class="va">`ER-targeted proteins`</span>,<span class="st">"_mRNA"</span>,sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tranlatome</span> <span class="op">&lt;-</span> <span class="va">ft</span></span>
<span></span>
<span><span class="co"># groups</span></span>
<span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cyto_nuc"</span>, <span class="st">"mito"</span>, <span class="st">"ER"</span>, <span class="st">"translatome"</span><span class="op">)</span></span>
<span><span class="va">glist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">cyto_nuc</span><span class="op">$</span><span class="va">gene</span>, <span class="va">mito</span><span class="op">$</span><span class="va">gene</span>, <span class="va">er</span><span class="op">$</span><span class="va">gene</span>, <span class="va">tranlatome</span><span class="op">$</span><span class="va">gene</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, calculate and plot the metagene profile data for genes of different categories:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># loop get data</span></span>
<span><span class="co"># x = 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">gp</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">mt</span> <span class="op">&lt;-</span> <span class="fu">metagene_plot</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj2</span>,</span>
<span>                      selected_genes <span class="op">=</span> <span class="va">glist</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                      mode <span class="op">=</span> <span class="st">"codon"</span>,</span>
<span>                      rel2st_dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">1500</span><span class="op">)</span>,</span>
<span>                      return_data <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">mt</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="va">gp</span><span class="op">[</span><span class="va">x</span><span class="op">]</span></span>
<span>  <span class="va">mt</span><span class="op">$</span><span class="va">tp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">mt</span><span class="op">$</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">gp</span><span class="op">[</span><span class="va">x</span><span class="op">]</span> <span class="op">==</span> <span class="st">"translatome"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">mt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">mt</span>, <span class="va">tp</span> <span class="op">==</span> <span class="st">"total"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">mt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">mt</span>, <span class="va">tp</span> <span class="op">==</span> <span class="st">"ip"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">mt</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>,<span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">mts</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="co"># add groups</span></span>
<span><span class="va">mts</span><span class="op">$</span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">mts</span><span class="op">$</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mts</span><span class="op">$</span><span class="va">rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">mts</span><span class="op">$</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_|-"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mts</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">rel</span>,y <span class="op">=</span> <span class="va">avg</span>,colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">rep</span><span class="op">~</span><span class="va">gp</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>        panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>,size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Codons / amino acids"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Mean read density [AU]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/mtssb3.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section></section><section id="impact-of-rac-on-co-translational-ssb-function" class="level2" data-number="18.5"><h2 data-number="18.5" class="anchored" data-anchor-id="impact-of-rac-on-co-translational-ssb-function">
<span class="header-section-number">18.5</span> Impact of RAC on co-translational ssb function</h2>
<p>By integrating ribosome profiling data with enrichment analysis and motif identification, the study maps Ssb interactions with high resolution and reveals its coordination with translation elongation and nascent chain folding. This provides a comprehensive understanding of Ssb’s role as a chaperone in co-translational protein folding:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/ssbfig5.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<section id="serp-object-construction" class="level3" data-number="18.5.1"><h3 data-number="18.5.1" class="anchored" data-anchor-id="serp-object-construction">
<span class="header-section-number">18.5.1</span> Serp object construction</h3>
<p>We reconstructed the relevant samples into&nbsp;<strong>SeRP objects</strong> for subsequent analyses:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># total bamfiles</span></span>
<span><span class="va">tt.bam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WT_Ssb1-GFP_translatome_rep1.bam"</span>,</span>
<span>            <span class="st">"WT_Ssb1-GFP_translatome_rep2.bam"</span>,</span>
<span>            <span class="st">"WT_Ssb2-GFP_translatome_rep1.bam"</span>,</span>
<span>            <span class="st">"WT_Ssb2-GFP_translatome_rep2.bam"</span>,</span>
<span>            <span class="st">"RAC_Ssb1-GFP_translatome_rep1.bam"</span>,</span>
<span>            <span class="st">"RAC_Ssb1-GFP_translatome_rep2.bam"</span>,</span>
<span>            <span class="st">"RAC_Ssb2-GFP_translatome_rep1.bam"</span>,</span>
<span>            <span class="st">"RAC_Ssb2-GFP_translatome_rep2.bam"</span>,</span>
<span>            <span class="st">"NAC_Ssb1-GFP_translatome_rep1.bam"</span>,</span>
<span>            <span class="st">"NAC_Ssb1-GFP_translatome_rep2.bam"</span>,</span>
<span>            <span class="st">"NAC_Ssb2-GFP_translatome_rep1.bam"</span>,</span>
<span>            <span class="st">"NAC_Ssb2-GFP_translatome_rep2.bam"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># interactome bam files</span></span>
<span><span class="va">ip.bam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WT_Ssb1_interactome_rep1.bam"</span>,</span>
<span>            <span class="st">"WT_Ssb1_interactome_rep2.bam"</span>,</span>
<span>            <span class="st">"WT_Ssb2_interactome_rep1.bam"</span>,</span>
<span>            <span class="st">"WT_Ssb2_interactome_rep2.bam"</span>,</span>
<span>            <span class="st">"RAC_Ssb1_interactome_rep1.bam"</span>,</span>
<span>            <span class="st">"RAC_Ssb1_interactome_rep2.bam"</span>,</span>
<span>            <span class="st">"RAC_Ssb2_interactome_rep1.bam"</span>,</span>
<span>            <span class="st">"RAC_Ssb2_interactome_rep2.bam"</span>,</span>
<span>            <span class="st">"NAC_Ssb1_interactome_rep1.bam"</span>,</span>
<span>            <span class="st">"NAC_Ssb1_interactome_rep2.bam"</span>,</span>
<span>            <span class="st">"NAC_Ssb2_interactome_rep1.bam"</span>,</span>
<span>            <span class="st">"NAC_Ssb2_interactome_rep2.bam"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># construct_serp</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">construct_serp</span><span class="op">(</span>genome_file <span class="op">=</span> <span class="st">"../../index-data/Saccharomyces_cerevisiae.R64-1-1.dna.toplevel.fa"</span>,</span>
<span>                      gtf_file <span class="op">=</span> <span class="st">"../../index-data/Saccharomyces_cerevisiae.R64-1-1.112.gtf"</span>,</span>
<span>                      mapping_type <span class="op">=</span> <span class="st">"genome"</span>,</span>
<span>                      assignment_mode <span class="op">=</span> <span class="st">"end5"</span>,</span>
<span>                      extend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      extend_upstream <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                      extend_downstream <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                      total_bam_file <span class="op">=</span> <span class="va">tt.bam</span>,</span>
<span>                      total_sample_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ssb1_rep1"</span>,<span class="st">"Ssb1_rep2"</span>,</span>
<span>                                            <span class="st">"Ssb2_rep1"</span>,<span class="st">"Ssb2_rep2"</span>,</span>
<span>                                            <span class="st">"RAC_Ssb1_rep1"</span>,<span class="st">"RAC_Ssb1_rep2"</span>,</span>
<span>                                            <span class="st">"RAC_Ssb2_rep1"</span>,<span class="st">"RAC_Ssb2_rep2"</span>,</span>
<span>                                            <span class="st">"NAC_Ssb1_rep1"</span>,<span class="st">"NAC_Ssb1_rep2"</span>,</span>
<span>                                            <span class="st">"NAC_Ssb2_rep1"</span>,<span class="st">"NAC_Ssb2_rep2"</span><span class="op">)</span>,</span>
<span>                      total_sample_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ssb1"</span>,<span class="st">"Ssb1"</span>,<span class="st">"Ssb2"</span>,<span class="st">"Ssb2"</span>,</span>
<span>                                             <span class="st">"RAC_Ssb1"</span>,<span class="st">"RAC_Ssb1"</span>,<span class="st">"RAC_Ssb2"</span>,<span class="st">"RAC_Ssb2"</span>,</span>
<span>                                             <span class="st">"NAC_Ssb1"</span>,<span class="st">"NAC_Ssb1"</span>,<span class="st">"NAC_Ssb2"</span>,<span class="st">"NAC_Ssb2"</span><span class="op">)</span>,</span>
<span>                      IP_bam_file <span class="op">=</span> <span class="va">ip.bam</span>,</span>
<span>                      IP_sample_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ssb1_rep1"</span>,<span class="st">"Ssb1_rep2"</span>,</span>
<span>                                         <span class="st">"Ssb2_rep1"</span>,<span class="st">"Ssb2_rep2"</span>,</span>
<span>                                         <span class="st">"RAC_Ssb1_rep1"</span>,<span class="st">"RAC_Ssb1_rep2"</span>,</span>
<span>                                         <span class="st">"RAC_Ssb2_rep1"</span>,<span class="st">"RAC_Ssb2_rep2"</span>,</span>
<span>                                         <span class="st">"NAC_Ssb1_rep1"</span>,<span class="st">"NAC_Ssb1_rep2"</span>,</span>
<span>                                         <span class="st">"NAC_Ssb2_rep1"</span>,<span class="st">"NAC_Ssb2_rep2"</span><span class="op">)</span>,</span>
<span>                      IP_sample_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ssb1"</span>,<span class="st">"Ssb1"</span>,<span class="st">"Ssb2"</span>,<span class="st">"Ssb2"</span>,</span>
<span>                                          <span class="st">"RAC_Ssb1"</span>,<span class="st">"RAC_Ssb1"</span>,<span class="st">"RAC_Ssb2"</span>,<span class="st">"RAC_Ssb2"</span>,</span>
<span>                                          <span class="st">"NAC_Ssb1"</span>,<span class="st">"NAC_Ssb1"</span>,<span class="st">"NAC_Ssb2"</span>,<span class="st">"NAC_Ssb2"</span><span class="op">)</span>,</span>
<span>                      choose_longest_trans <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># generate summary data for QC or other analysis</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">generate_summary</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                        exp_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"total"</span>,<span class="st">"ip"</span><span class="op">)</span>, </span>
<span>                        nThreads <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="adding-offset-information" class="level3" data-number="18.5.2"><h3 data-number="18.5.2" class="anchored" data-anchor-id="adding-offset-information">
<span class="header-section-number">18.5.2</span> Adding offset information</h3>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># offset correction</span></span>
<span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ssb1_rep1"</span>,<span class="st">"Ssb1_rep2"</span>,</span>
<span>        <span class="st">"Ssb2_rep1"</span>,<span class="st">"Ssb2_rep2"</span>,</span>
<span>        <span class="st">"RAC_Ssb1_rep1"</span>,<span class="st">"RAC_Ssb1_rep2"</span>,</span>
<span>        <span class="st">"RAC_Ssb2_rep1"</span>,<span class="st">"RAC_Ssb2_rep2"</span>,</span>
<span>        <span class="st">"NAC_Ssb1_rep1"</span>,<span class="st">"NAC_Ssb1_rep2"</span>,</span>
<span>        <span class="st">"NAC_Ssb2_rep1"</span>,<span class="st">"NAC_Ssb2_rep2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">offset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">sp</span>,<span class="st">"total"</span>,sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">sp</span>,<span class="st">"ip"</span>,sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                  each <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>                     qwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">35</span>,<span class="fl">24</span><span class="op">)</span>,</span>
<span>                     rel_pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">11</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>,<span class="fl">24</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">obj</span><span class="op">@</span><span class="va">reads_offset_info</span> <span class="op">&lt;-</span> <span class="va">offset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="metagene-profile-for-rac-depletion" class="level3" data-number="18.5.3"><h3 data-number="18.5.3" class="anchored" data-anchor-id="metagene-profile-for-rac-depletion">
<span class="header-section-number">18.5.3</span> Metagene profile for RAC depletion</h3>
<p>Use the&nbsp;<code>subset_data</code>&nbsp;function to filter and analyze samples with <strong>Ssb</strong> and <strong>RAC deletions</strong>:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ==============================================================================</span></span>
<span><span class="co"># choose RAC and ssb for analysis</span></span>
<span><span class="va">obj2</span> <span class="op">&lt;-</span> <span class="fu">subset_data</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>, <span class="va">sample_group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ssb1"</span>, <span class="st">"Ssb2"</span>, <span class="st">"RAC_Ssb1"</span>,<span class="st">"RAC_Ssb2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mt</span> <span class="op">&lt;-</span> <span class="fu">metagene_plot</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj2</span>,</span>
<span>                    mode <span class="op">=</span> <span class="st">"codon"</span>,</span>
<span>                    rel2st_dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">1500</span><span class="op">)</span>,</span>
<span>                    return_data <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add groups</span></span>
<span><span class="va">mt</span><span class="op">$</span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">mt</span><span class="op">$</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mt</span><span class="op">$</span><span class="va">tp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">mt</span><span class="op">$</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mt</span> <span class="op">&lt;-</span> <span class="va">mt</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html">startsWith</a></span><span class="op">(</span><span class="va">sample</span>, <span class="st">"Ssb"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_|-"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                       <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html">startsWith</a></span><span class="op">(</span><span class="va">sample</span>, <span class="st">"Ssb"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_|-"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>                                       <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ft <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html">startsWith</a></span><span class="op">(</span><span class="va">sample</span>, <span class="st">"Ssb"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                                       <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html">startsWith</a></span><span class="op">(</span><span class="va">sample</span>, <span class="st">"Ssb"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mt</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">rel</span>,y <span class="op">=</span> <span class="va">avg</span>,colour <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">ft</span><span class="op">~</span><span class="va">rep</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>        panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>,size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Codons / amino acids"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Mean read density [AU]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/mtssb4.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section><section id="ssb1-interaction-profiles-for-exemplary-proteins" class="level3" data-number="18.5.4"><h3 data-number="18.5.4" class="anchored" data-anchor-id="ssb1-interaction-profiles-for-exemplary-proteins">
<span class="header-section-number">18.5.4</span> Ssb1 interaction profiles for exemplary proteins</h3>
<p>The authors presented the interaction profiles of Ssb1 for the exemplary genes&nbsp;<strong><em>ssc1</em></strong>&nbsp;and&nbsp;<strong><em>cbf5</em></strong>. They observed that the deletion of RAC significantly influenced the co-translational binding dynamics of Ssb, leading to altered binding distributions and a notable delay in its engagement with nascent chains. To showcase these effects and deepen our understanding, we extracted the data to visualize the binding profiles of Ssb1 and Ssb2 in the context of RAC deletion:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">glist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SSC1"</span>, <span class="st">"CBF5"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># x = 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">glist</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">obj2</span> <span class="op">&lt;-</span> <span class="fu">get_occupancy</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj2</span>, </span>
<span>                       serp_exp <span class="op">=</span> <span class="st">"total"</span>,</span>
<span>                       gene_name <span class="op">=</span> <span class="va">glist</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,</span>
<span>                       coordinate_to_trans <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                       do_reads_offset <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">obj2</span> <span class="op">&lt;-</span> <span class="fu">get_occupancy</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj2</span>, </span>
<span>                       serp_exp <span class="op">=</span> <span class="st">"ip"</span>,</span>
<span>                       gene_name <span class="op">=</span> <span class="va">glist</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,</span>
<span>                       coordinate_to_trans <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                       do_reads_offset <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">pdf</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">enrichment_plot2</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj2</span>,</span>
<span>                     smooth <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                     window_size <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                     mode <span class="op">=</span> <span class="st">"codon"</span>,</span>
<span>                     merge_rep <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                     facet <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">rname</span><span class="op">)</span>,</span>
<span>                     return_data <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">pdf</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>,<span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">pdf</span></span>
<span></span>
<span><span class="co"># re-plot</span></span>
<span></span>
<span><span class="va">pdf</span><span class="op">$</span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">pdf</span><span class="op">$</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pdf</span> <span class="op">&lt;-</span> <span class="va">pdf</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">gp</span><span class="op">)</span>, <span class="va">sample</span>, <span class="va">gp</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check</span></span>
<span><span class="co"># head(pdf)</span></span>
<span><span class="co">#     sample             rname pos     rpm.x     rpm.y sm1 sm2 sd smratio   gp</span></span>
<span><span class="co"># 1 RAC_Ssb1 YJR045C_mRNA|SSC1   1 0.8387263 0.5019538   0   0  0       0 Ssb1</span></span>
<span><span class="co"># 2 RAC_Ssb1 YJR045C_mRNA|SSC1   2 0.6155070 0.3005195   0   0  0       0 Ssb1</span></span>
<span><span class="co"># 3 RAC_Ssb1 YJR045C_mRNA|SSC1   3 0.2795754 0.1721372   0   0  0       0 Ssb1</span></span>
<span><span class="co"># 4 RAC_Ssb1 YJR045C_mRNA|SSC1   4 0.2795754 0.2426880   0   0  0       0 Ssb1</span></span>
<span><span class="co"># 5 RAC_Ssb1 YJR045C_mRNA|SSC1   5 0.5012232 0.2881815   0   0  0       0 Ssb1</span></span>
<span><span class="co"># 6 RAC_Ssb1 YJR045C_mRNA|SSC1   6 1.3352958 0.6264777   0   0  0       0 Ssb1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>plotting data:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">pdf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">smratio</span> <span class="op">-</span> <span class="va">sd</span>,</span>
<span>                  ymax <span class="op">=</span> <span class="va">smratio</span> <span class="op">+</span> <span class="va">sd</span>,</span>
<span>                  x <span class="op">=</span> <span class="va">pos</span>,y <span class="op">=</span> <span class="va">smratio</span>,</span>
<span>                  fill <span class="op">=</span> <span class="va">sample</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">pos</span>,y <span class="op">=</span> <span class="va">smratio</span>, color <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>,lty <span class="op">=</span> <span class="st">"dashed"</span>,color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">gp</span><span class="op">~</span><span class="va">rname</span>,scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>        strip.text.y.left <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        strip.background <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        strip.placement <span class="op">=</span> <span class="st">"outside"</span>,</span>
<span>        ggside.panel.background <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        ggside.panel.border <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Ribosome position (codons / amino acids)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Mean enrichment (IP / total)[AU]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/sgr3.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section></section><section id="interplay-of-ssb-and-nac" class="level2" data-number="18.6"><h2 data-number="18.6" class="anchored" data-anchor-id="interplay-of-ssb-and-nac">
<span class="header-section-number">18.6</span> Interplay of ssb and NAC</h2>
<p>These findings in <strong>figure 6</strong> demonstrate that NAC synergistically promotes broader Ssb binding to nascent chains by increasing the number and intensity of Ssb-binding events. However, the absence of NAC does not alter Ssb’s substrate selectivity or the positional characteristics of its binding sites:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/ssbfig6.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<section id="metagene-profile-for-nac-depletion" class="level3" data-number="18.6.1"><h3 data-number="18.6.1" class="anchored" data-anchor-id="metagene-profile-for-nac-depletion">
<span class="header-section-number">18.6.1</span> Metagene profile for NAC depletion</h3>
<p>Filter NAC samples, with the analysis workflow similar to the above:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ==============================================================================</span></span>
<span><span class="co"># choose NAC and ssb for analysis</span></span>
<span><span class="va">obj3</span> <span class="op">&lt;-</span> <span class="fu">subset_data</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>, <span class="va">sample_group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ssb1"</span>, <span class="st">"Ssb2"</span>, <span class="st">"NAC_Ssb1"</span>,<span class="st">"NAC_Ssb2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mt</span> <span class="op">&lt;-</span> <span class="fu">metagene_plot</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj3</span>,</span>
<span>                    mode <span class="op">=</span> <span class="st">"codon"</span>,</span>
<span>                    rel2st_dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">1500</span><span class="op">)</span>,</span>
<span>                    return_data <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add groups</span></span>
<span><span class="va">mt</span><span class="op">$</span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">mt</span><span class="op">$</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mt</span><span class="op">$</span><span class="va">tp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">mt</span><span class="op">$</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mt</span> <span class="op">&lt;-</span> <span class="va">mt</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html">startsWith</a></span><span class="op">(</span><span class="va">sample</span>, <span class="st">"Ssb"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_|-"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                       <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html">startsWith</a></span><span class="op">(</span><span class="va">sample</span>, <span class="st">"Ssb"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_|-"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ft <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html">startsWith</a></span><span class="op">(</span><span class="va">sample</span>, <span class="st">"Ssb"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                                      <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html">startsWith</a></span><span class="op">(</span><span class="va">sample</span>, <span class="st">"Ssb"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mt</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">rel</span>,y <span class="op">=</span> <span class="va">avg</span>,colour <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">ft</span><span class="op">~</span><span class="va">rep</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>        panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>,size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Codons / amino acids"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Mean read density [AU]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/mtssb5.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section><section id="ssb1-interaction-profiles" class="level3" data-number="18.6.2"><h3 data-number="18.6.2" class="anchored" data-anchor-id="ssb1-interaction-profiles">
<span class="header-section-number">18.6.2</span> Ssb1 interaction profiles</h3>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ==============================================================================</span></span>
<span><span class="va">glist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CDC19"</span>, <span class="st">"PMT1"</span>, <span class="st">"PDI1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># x = 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">glist</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">obj3</span> <span class="op">&lt;-</span> <span class="fu">get_occupancy</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj3</span>, </span>
<span>                        serp_exp <span class="op">=</span> <span class="st">"total"</span>,</span>
<span>                        gene_name <span class="op">=</span> <span class="va">glist</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,</span>
<span>                        coordinate_to_trans <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                        do_reads_offset <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">obj3</span> <span class="op">&lt;-</span> <span class="fu">get_occupancy</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj3</span>, </span>
<span>                        serp_exp <span class="op">=</span> <span class="st">"ip"</span>,</span>
<span>                        gene_name <span class="op">=</span> <span class="va">glist</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,</span>
<span>                        coordinate_to_trans <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                        do_reads_offset <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">pdf</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">enrichment_plot2</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj3</span>,</span>
<span>                     smooth <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                     window_size <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                     mode <span class="op">=</span> <span class="st">"codon"</span>,</span>
<span>                     merge_rep <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                     facet <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">rname</span><span class="op">)</span>,</span>
<span>                     return_data <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">pdf</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>,<span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">pdf</span></span>
<span></span>
<span><span class="co"># re-plot</span></span>
<span></span>
<span><span class="va">pdf</span><span class="op">$</span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">pdf</span><span class="op">$</span><span class="va">sample</span>,split <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pdf</span> <span class="op">&lt;-</span> <span class="va">pdf</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">gp</span><span class="op">)</span>, <span class="va">sample</span>, <span class="va">gp</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">pdf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">smratio</span> <span class="op">-</span> <span class="va">sd</span>,</span>
<span>                  ymax <span class="op">=</span> <span class="va">smratio</span> <span class="op">+</span> <span class="va">sd</span>,</span>
<span>                  x <span class="op">=</span> <span class="va">pos</span>,y <span class="op">=</span> <span class="va">smratio</span>,</span>
<span>                  fill <span class="op">=</span> <span class="va">sample</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">pos</span>,y <span class="op">=</span> <span class="va">smratio</span>, color <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>,lty <span class="op">=</span> <span class="st">"dashed"</span>,color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">gp</span><span class="op">~</span><span class="va">rname</span>,scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>        strip.text.y.left <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        strip.background <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        strip.placement <span class="op">=</span> <span class="st">"outside"</span>,</span>
<span>        ggside.panel.background <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        ggside.panel.border <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Ribosome position (codons / amino acids)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Mean enrichment (IP / total)[AU]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="image/sgr4.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/github\.com\/junjunlab\/riboTransVis");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./DENR-promotes-translation-reinitiation.html" class="pagination-link" aria-label="DENR promotes translation reinitiation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">DENR promotes translation reinitiation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>riboTransVis documentation was written by Jun Zhang.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/junjunlab/riboTransVis/edit/main/Profiling-Ssb-Nascent-Chain.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/junjunlab/riboTransVis/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>